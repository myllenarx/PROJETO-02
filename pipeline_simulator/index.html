<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Simulador Pipeline – Arquitetura II</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <header class="topbar">
    <h1>Simulador Pipeline (Arquitetura II)</h1>
    <div class="top-actions">
      <button id="btn-help" title="Ajuda rápida">Ajuda</button>
      <button id="btn-graphs" title="Abrir painel de gráficos">Ver Gráficos</button>
    </div>
  </header>

  <main class="layout">
    <section class="left-panel">
      <div class="card">
        <h2>Benchmark</h2>
        <select id="benchmark-select" aria-label="Escolha benchmark">
          <option value="">-- Selecione um benchmark --</option>
          <option value="alu1">ALU 1 - Somatório simples</option>
          <option value="alu2">ALU 2 - Operações encadeadas</option>
          <option value="mem1">MEM 1 - Leitura sequencial</option>
          <option value="mem2">MEM 2 - Escrita sequencial</option>
          <option value="ctrl1">CTRL 1 - Loop simples (branch taken)</option>
          <option value="ctrl2">CTRL 2 - Branch alternado (taken/not taken)</option>
        </select>
      </div>

      <div class="card">
        <h2>Programa</h2>
        <textarea id="program-input" placeholder="// Código Assembly aqui...">// Exemplo:
addi x1, x0, 4
addi x2, x0, 10
sw x2, 0(x1)
lw x3, 0(x1)
add x4, x3, x2
addi x5, x0, 1
beq x5, x0, 2
add x6, x1, x1
nop
        </textarea>

        <div class="controls">
          <button id="btn-load">Carregar Programa</button>
          <button id="btn-step">Próximo Ciclo</button>
          <button id="btn-run">Executar Tudo</button>
          <button id="btn-reset">Resetar</button>
          <button id="btn-export">Exportar CSV</button>
        </div>
      </div>

      <div class="card small">
        <h2>Benchmarks rápidos</h2>
        <div class="bench-grid">
          <button class="bench" data-prog="alu1">ALU 1</button>
          <button class="bench" data-prog="alu2">ALU 2</button>
          <button class="bench" data-prog="mem1">MEM 1</button>
          <button class="bench" data-prog="mem2">MEM 2</button>
          <button class="bench" data-prog="ctrl1">CTRL 1</button>
          <button class="bench" data-prog="ctrl2">CTRL 2</button>
        </div>
      </div>
    </section>

    <section class="right-panel">
      <div class="card">
        <h2>Pipeline</h2>
        <table id="pipeline">
          <thead>
            <tr>
              <th>IF</th>
              <th>ID</th>
              <th>EX</th>
              <th>MEM</th>
              <th>WB</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td id="stage-if">-</td>
              <td id="stage-id">-</td>
              <td id="stage-ex">-</td>
              <td id="stage-mem">-</td>
              <td id="stage-wb">-</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="card" id="registers-card">
        <h2>Registradores</h2>
        <div id="registers-container">
          <table id="registers">
            <thead>
              <tr>
                <th>Registrador</th>
                <th>Valor</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>

      <div class="card">
        <h2>Métricas</h2>
        <table id="metrics">
          <thead>
            <tr>
              <th>Ciclos</th>
              <th>CPI</th>
              <th>Stalls</th>
              <th>Flushes</th>
              <th>Branch (acertos)</th>
              <th>CacheI</th>
              <th>CacheD</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td id="metrics-cycles">0</td>
              <td id="metrics-cpi">0</td>
              <td id="metrics-stalls">0</td>
              <td id="metrics-flushes">0</td>
              <td id="metrics-branch">0/0</td>
              <td id="metrics-ci">0</td>
              <td id="metrics-cd">0</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="card diagram-wrap" id="pipeline-diagram-container">
        <h3>Diagrama de Pipeline (ciclo a ciclo)</h3>
        <div class="content" style="padding:0;">
          <table class="diagram">
            <thead>
              <tr id="pipeline-diagram-header">
                <th>Instrução</th>
              </tr>
            </thead>
            <tbody id="pipeline-diagram-body">
            </tbody>
          </table>
        </div>
      </div>

      <h3>Caches:</h3>
      <div id="cache-container">
        <table id="cache-table">
          <tr>
            <th>Cache</th>
            <th>Hits</th>
            <th>Misses</th>
            <th>Taxa de Acerto (%)</th>
          </tr>
          <tr>
            <td>L1I</td>
            <td id="cache-l1i-hits">0</td>
            <td id="cache-l1i-misses">0</td>
            <td id="cache-l1i-rate">0</td>
          </tr>
          <tr>
            <td>L1D</td>
            <td id="cache-l1d-hits">0</td>
            <td id="cache-l1d-misses">0</td>
            <td id="cache-l1d-rate">0</td>
          </tr>
          <tr>
            <td>L2</td>
            <td id="cache-l2-hits">0</td>
            <td id="cache-l2-misses">0</td>
            <td id="cache-l2-rate">0</td>
          </tr>
          <tr>
            <td>L3</td>
            <td id="cache-l3-hits">0</td>
            <td id="cache-l3-misses">0</td>
            <td id="cache-l3-rate">0</td>
          </tr>
        </table>
      </div>

    </section>
  </main>

  <!-- scripts: cache.js and pipeline.js (originais) e main que liga a UI -->
  <script src="cache.js"></script>
  <script src="pipeline.js"></script>
  <script src="main.js"></script>
</body>

</html>